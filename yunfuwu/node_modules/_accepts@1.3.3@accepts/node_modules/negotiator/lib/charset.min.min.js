"use strict";module.exports=preferredCharsets;module.exports.preferredCharsets=preferredCharsets;var simpleCharsetRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseAcceptCharset(i){var j=i.split(",");for(var f=0,g=0;f<j.length;f++){var h=parseCharset(j[f].trim(),f);if(h){j[g++]=h}}j.length=g;return j}function parseCharset(k,h){var i=simpleCharsetRegExp.exec(k);if(!i){return null}var j=i[1];var n=1;if(i[2]){var l=i[2].split(";");for(var h=0;h<l.length;h++){var m=l[h].trim().split("=");if(m[0]==="q"){n=parseFloat(m[1]);break}}}return{charset:j,q:n,i:h}}function getCharsetPriority(i,j,g){var k={o:-1,q:0,s:0};for(var l=0;l<j.length;l++){var h=specify(i,j[l],g);if(h&&(k.s-h.s||k.q-h.q||k.o-h.o)<0){k=h}}return k}function specify(g,f,e){var h=0;if(f.charset.toLowerCase()===g.toLowerCase()){h|=1}else{if(f.charset!=="*"){return null}}return{i:e,o:f.i,q:f.q,s:h}}function preferredCharsets(j,g){var k=parseAcceptCharset(j===undefined?"*":j||"");if(!g){return k.filter(isQuality).sort(compareSpecs).map(getFullCharset)}var l=g.map(function i(a,b){return getCharsetPriority(a,k,b)});return l.filter(isQuality).sort(compareSpecs).map(function h(a){return g[l.indexOf(a)]})}function compareSpecs(a,b){return(b.q-a.q)||(b.s-a.s)||(a.o-b.o)||(a.i-b.i)||0}function getFullCharset(b){return b.charset}function isQuality(b){return b.q>0};